if(typeof Meio=="undefined"){var Meio={}}$extend(Element.NativeEvents,{"paste":2,"input":2});Element.Events.paste={base:(Browser.Engine.presto||(Browser.Engine.gecko&&Browser.Engine.version<19))?"input":"paste",condition:function(A){this.fireEvent("paste",A,1);return false}};Meio.Mask=new Class({Implements:[Options,Events],eventsToBind:["focus","blur","keydown","keypress","paste"],options:{selectOnFocus:true},initialize:function(B,A){this.element=$(B);if(this.element.get("tag")!=="input"||this.element.get("type")!=="text"){return }this.setup(A)},setup:function(A){this.setOptions(A);if(this.element.retrieve("meiomask")){this.remove()}this.ignore=false;this.maxlength=this.element.get("maxlength");this.eventsToBind.each(function(D){this.element.addEvent(D,this.onMask.bindWithEvent(this,this[D]))},this);this.element.store("meiomask",this).erase("maxlength");var C=this.element.get("value");if(C!==""){var B=C.meiomask(this.constructor,this.options);this.element.set("value",B).defaultValue=B}return this},remove:function(){var A=this.element.retrieve("meiomask");if(A){var B=A.maxlength;if(B!==null){this.element.set("maxlength",B)}A.eventsToBind.each(function(C){this.element.removeEvent(C,this[C])},A);this.element.eliminate("meiomask")}return this},onMask:function(B,A){if(this.element.get("readonly")){return true}var C={};C.range=this.element.getSelectedRange();C.isSelection=(C.range.start!==C.range.end);C.isDelKey=(B.event.keyCode==46);C.isBksKey=(B.event.keyCode==8||(Browser.Platform.ipod&&B.code==127));C.isRemoveKey=(C.isBksKey||C.isDelKey);A.call(this,B,C);return true},keydown:function(B,C){this.ignore=(Meio.Mask.ignoreKeys[B.code]&&!C.isRemoveKey)||B.control||B.meta||B.alt;if(this.ignore||C.isRemoveKey){var A=Meio.Mask.ignoreKeys[B.code]||"";this.fireEvent("valid",[this.element,B.code,A])}(Browser.Platform.ipod||(Meio.Mask.onlyKeyDownRepeat&&C.isRemoveKey))?this.keypress(B,C):true},focus:function(B,C){var A=this.element;A.store("meiomask:focusvalue",A.get("value"))},blur:function(B,C){var A=this.element;if(A.retrieve("meiomask:focusvalue")!=A.get("value")){A.fireEvent("change")}},setSize:function(){if(!this.element.get("size")){this.element.set("size",this.maskArray.length)}},isFixedChar:function(A){return !Meio.Mask.matchRules.contains(A)}});Meio.Mask.extend({matchRules:"",rulesRegex:new RegExp(""),rules:{},setRule:function(A,B){this.setRules({ruleKey:B})},setRules:function(A){$extend(this.rules,A);var B=[];for(rule in A){B.push(rule)}this.matchRules+=B.join("");this.recompileRulesRegex()},removeRule:function(A){delete this.rules[A];this.matchRules=this.matchRules.replace(A,"");this.recompileRulesRegex()},removeRules:function(){var A=Array.flatten(arguments);for(var B=A.length;B--;){this.removeRule(A[B])}},recompileRulesRegex:function(){this.rulesRegex.compile("["+this.matchRules.escapeRegExp()+"]","g")},createMasks:function(B,A){B=B.capitalize();for(mask in A){this[B][mask.camelCase().capitalize()]=new Class({Extends:this[B],options:A[mask]})}},upTo:function(A){A=""+A;return function(D,C,B){if(D.charAt(C-1)==A[0]){return(B<=A[1])}return true}},onlyKeyDownRepeat:(Browser.Engine.trident||(Browser.Engine.webkit&&Browser.Engine.version>=525))}).extend(function(){var B;var D={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"alt",27:"esc",33:"page up",34:"page down",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",224:"command"},C={10:"go",127:"delete"};if(Browser.Platform.ipod){B=C}else{for(var A=1;A<=12;A++){D[111+A]="f"+A}B=D}return{ignoreKeys:B}}()).setRules((function(){var B={"z":{regex:/[a-z]/},"Z":{regex:/[A-Z]/},"a":{regex:/[a-zA-Z]/},"*":{regex:/[0-9a-zA-Z]/},"@":{regex:/[0-9a-zA-ZçáàãâéèêíìóòõôúùüñÇÁÀÃÂÉÈÊÍÌÓÒÕÔÚÙÜÑ]/},"h":{regex:/[0-9]/,check:Meio.Mask.upTo(23)},"d":{regex:/[0-9]/,check:Meio.Mask.upTo(31)},"m":{regex:/[0-9]/,check:Meio.Mask.upTo(12)}};for(var A=0;A<=9;A++){B[A]={regex:new RegExp("[0-"+A+"]")}}return B})());Meio.Mask.Fixed=new Class({Extends:Meio.Mask,options:{autoSetSize:false,placeholder:"_",removeIfInvalid:false,removeInvalidTrailingChars:true},initialize:function(B,A){this.parent(B,A);this.maskArray=this.options.mask.split("");this.maskMold=this.element.get("value")||this.options.mask.replace(Meio.Mask.rulesRegex,this.options.placeholder);this.maskMoldArray=this.maskMold.split("");this.validIndexes=[];if(this.options.autoSetSize){this.setSize()}this.maskArray.each(function(D,C){if(!this.isFixedChar(D)){this.validIndexes.push(C)}},this);this.createUnmaskRegex()},focus:function(A,B){this.element.set("value",this.maskMoldArray.join(""));if(this.options.selectOnFocus){this.element.select()}this.parent(A,B)},blur:function(A,C){this.parent(A,C);var B=this.element.get("value");if(this.options.removeIfInvalid){if(B.contains(this.options.placeholder)){this.maskMoldArray=this.maskMold.split("");this.element.set("value","")}return true}if(this.options.removeInvalidTrailingChars){this.removeInvalidTrailingChars(B)}return true},keypress:function(J,D){if(this.ignore){return true}J.preventDefault();var K=String.fromCharCode(J.code),E=this.maskArray,C,G,B;if(!D.isSelection){var H;if(D.isBksKey){do{C=this.validIndexes.indexOf(--D.range.start)}while(C===-1&&D.range.start>=0);H=this.validIndexes[C]||0}else{do{C=this.validIndexes.indexOf(D.range.start++)}while(C===-1&&D.range.start<E.length);H=this.validIndexes[C+1]}G=this.validIndexes[C];if(!(B=this.testEvents(G,K,J.code,D.isRemoveKey))){return true}if($type(B)==="string"){K=B}this.maskMoldArray[G]=(D.isRemoveKey)?this.options.placeholder:K;this.element.set("value",this.maskMoldArray.join("")).setRange($pick(H,this.maskMoldArray.length))}else{var A=D.range.start,I=D.range.end,F;do{C=this.validIndexes.indexOf(D.range.start++)}while(C===-1&&D.range.start<E.length);do{F=this.validIndexes.indexOf(D.range.end++)}while(F===-1&&D.range.end<E.length);if(!(F-C)){return true}for(G=A;G<I;G++){this.maskMoldArray[G]=this.maskMold.charAt(G)}if(!D.isRemoveKey){G=this.validIndexes[C];if(!(B=this.testEvents(G,K,J.code,D.isRemoveKey))){return true}if($type(B)==="string"){K=B}this.maskMoldArray[G]=K;C++}this.element.set("value",this.maskMoldArray.join(""));this.element.setRange(this.validIndexes[C])}return true},paste:function(B,C){var A=this.applyMask(this.element.get("value"),C.range.start);this.maskMoldArray=A.value;this.element.set("value",this.maskMoldArray.join("")).setRange(A.rangeStart);return true},mask:function(A){return this.applyMask(A).value.join("")},unmask:function(A){return A.replace(this.unmaskRegex,"")},createUnmaskRegex:function(){var A=[].combine(this.options.mask.replace(Meio.Mask.rulesRegex,"").split(""));this.unmaskRegex=new RegExp("["+A.join("").escapeRegExp()+"]","g")},applyMask:function(G,D){var A=G.split(""),C=this.maskArray,E=this.maskMold,B=0,F;while(B<E.length){if(!A[B]){A[B]=E[B]}else{if(Meio.Mask.rules[C[B]]){if(!(F=this.testEntry(B,A[B]))){A.splice(B,1);continue}else{if($type(F)==="string"){A[B]=F}}newStartRange=B}else{if(C[B]!=A[B]){A.splice(B,0,E[B])}else{A[B]=E[B]}}}B++}return{value:A.slice(0,this.maskMold.length),rangeStart:D+1}},removeInvalidTrailingChars:function(E){var B=E.length,D=this.options.placeholder,C=E.length-1,A;while(C>=0){A=false;while(this.isFixedChar(E.charAt(C))&&E.charAt(C)!==D){A=true;C--}while(E.charAt(C)===D){A=true;B=C;C--}if(!A){break}}this.element.set("value",E.substring(0,B))},testEntry:function(D,A){var C=this.maskArray,E=Meio.Mask.rules[C[D]],B=(E&&E.regex.test(A));return(E.check&&B)?E.check(this.element.get("value"),D,A):B},testEvents:function(D,A,E,G){var C=this.maskArray,F=Meio.Mask.rules[C[D]],H;if(!G){var B=B=[this.element,E,A];if(!F||!(H=this.testEntry(D,A))){this.fireEvent("invalid",B);return false}this.fireEvent("valid",B)}return H||true}});Meio.Mask.createMasks("Fixed",{"Phone":{mask:"(99) 9999-9999"},"PhoneUs":{mask:"(999) 999-9999"},"Cpf":{mask:"999.999.999-99"},"Cnpj":{mask:"99.999.999/9999-99"},"Date":{mask:"3d/1m/9999"},"DateUs":{mask:"1m/3d/9999"},"Cep":{mask:"99999-999"},"Time":{mask:"2h:59"},"CC":{mask:"9999 9999 9999 9999"}});Meio.Mask.Reverse=new Class({Extends:Meio.Mask,options:{autoSetSize:false,alignText:true,symbol:"",precision:2,decimal:",",thousands:".",maxLength:19},initialize:function(B,A){this.parent(B,A);var E=this.options.decimal.escapeRegExp(),D=this.options.thousands,F=D.escapeRegExp();if(this.options.alignText){this.element.setStyle("text-align","right")}this.maxlength=this.maxlength||this.options.maxLength;this.thousandsRegex=/(\d+)(\d{3})/;this.removeLeadingZerosRegex=/^0+(.*)$/;this.decimalNumberRegex=/^\d$/;this.thousandsReplaceStr="$1"+D+"$2";this.thousandsReplaceRegex=new RegExp(F,"g");this.cleanupRegex=new RegExp("["+F+E+"]","g");var C=this.element.get("value");if(C===""){C=this.mask(C);this.element.set("value",C).defaultValue=C}},focus:function(D,E){var A=this.element,B=A.get("value"),C=this.options.symbol;A.set("value",(B=this.getValue(B,true)));if(this.options.selectOnFocus){A.setRange(C.length,B.length)}this.parent(D,E)},blur:function(B,C){this.parent(B,C);var A=this.element;A.set("value",this.getValue(A.get("value")))},keypress:function(B,D){if(this.ignore){return true}B.preventDefault();var A=String.fromCharCode(B.code),C=this.element.get("value");C=D.isRemoveKey?C.substring(0,C.length-1):this.getValue(C+A);if(!this.testEvents(C.length,A,B.code,D.isRemoveKey)){return true}C=this.forceMask(C,true);this.element.set("value",C).setRange(C.length);return true},testEvents:function(E,A,C,D){var B=[this.element,C,A];if(!D){if(!(this.decimalNumberRegex).test(A)||E>=this.maxlength){this.fireEvent("invalid",B);return false}this.fireEvent("valid",B)}return true},paste:function(B,C){B.preventDefault();var A=this.element;elValue=A.get("value");A.set("value",(elValue=this.forceMask(elValue,true))).setRange(elValue.length);return true},forceMask:function(E,D){E=this.cleanup(E);var A=this.options.precision;if(A){var B=A+1-E.length;if(B>0){E=this.zeroize(E,B)}var C=E.length-A;E=E.substring(0,C)+this.options.decimal+E.substring(C)}return this.getValue(this.maskThousands(E),D)},cleanup:function(A){return this.getValue(A.replace(this.cleanupRegex,"")).replace(this.removeLeadingZerosRegex,"$1")},mask:function(B,A){B=B||"0";B=this.unmask(B).replace(".",this.options.decimal);return this.getValue(this.maskThousands(B),A)},unmask:function(A){return this.toNumber(this.getValue(A))},toNumber:function(C){if(!isFinite(C)){var B=this.options.thousands,A=this.options.decimal;if(B){C=C.replace(this.thousandsReplaceRegex,"")}if(A){C=C.replace(A,".")}}return C.toFloat().toFixed(this.options.precision)},getValue:function(C,B){var A=this.options.symbol;return(C.substring(0,A.length)===A)?B?C:C.substring(A.length):B?A+C:C},maskThousands:function(A){if(this.options.thousands){while(this.thousandsRegex.test(A)){A=A.replace(this.thousandsRegex,this.thousandsReplaceStr)}}return A},zeroize:function(B,A){while(A--){B="0"+B}return B}});Meio.Mask.createMasks("Reverse",{"Integer":{precision:0,maxLength:20},"Decimal":{},"DecimalUs":{thousands:",",decimal:"."},"Reais":{symbol:"R$ "},"Dollar":{symbol:"US$ ",thousands:",",decimal:"."}});Meio.Mask.Repeat=new Class({Extends:Meio.Mask,_keyup:function(A,B){return true},_paste:function(A,B){this.$el.set("value",this.__mask(B.valueArray,this.globals,this.mask.options));return true},_keypress:function(C,D){if(this.ignore||C.control||C.meta||C.alt){return true}var E=String.fromCharCode(C.code),A=this.mask.options.maskArray,B=D.value.replace(this.globals.fixedCharsRegG,"").split("");if(!this.testEvents(A,0,E,C.code)){return false}this.$el.set("value",B.join(""));return true}});Meio.Mask.Regexp=new Class({Extends:Meio.Mask,options:{},initialize:function(B,A){this.parent(B,A);this.regex=new RegExp(this.options.regex)},keypress:function(C,D){if(this.ignore){return true}C.preventDefault();var A=String.fromCharCode(C.code),B=this.element.get("value");B=B.substring(0,D.range.start)+(D.isRemoveKey?"":A)+B.substring(D.range.end);if(this.regex.test(B)){this.element.set("value",B)}return true}});Meio.Mask.createMasks("Regexp",{"Ip":{regex:/^(\d{1,3})(\.\d{1,3}){0,3}?$/,maxLength:15}});(function(){Meio.Mask.dumbInput=new Element("input",{"type":"text"});var A=function(D){return D.camelCase().capitalize()};var C=function(F){var G=[];F=Array.link(F,{mask:String.type,type:String.type,options:Object.type,klass:Class.type});if(F.mask){G=F.mask.contains(".")?F.mask.split("."):[F.type,F.mask]}var D=F.klass||Meio.Mask[A(G[0])][A(G[1])],E=F.options||{};return{klass:D,options:E}};var B=function(E,D){var F=C(D);Meio.Mask.dumbInput.set("value","");return new F.klass(Meio.Mask.dumbInput,F.options)[E](this)};String.implement({meiomask:function(){return B.call(this,"mask",arguments)},meiounmask:function(){return B.call(this,"unmask",arguments)}});Element.Properties.meiomask={set:function(){var D=C(arguments);return this.store("meiomask",new D.klass(this,D.options))},get:function(){return this.retrieve("meiomask")},erase:function(){var D=this.retrieve("meiomask");if(D){D.remove()}return this}};Element.Properties.maxLength=Element.Properties.maxlength={set:function(D){this.setAttribute("maxLength",D);return this},get:function(){var D=this.getAttribute("maxLength",2);return(D===2147483647)?null:D},erase:function(){this.removeAttribute("maxLength");return this}};Element.implement({meiomask:function(D,F,E){return this.set("meiomask",D,F,E)}})})()if(typeof Meio=="undefined"){var Meio={}}$extend(Element.NativeEvents,{"paste":2,"input":2});Element.Events.paste={base:(Browser.Engine.presto||(Browser.Engine.gecko&&Browser.Engine.version<19))?"input":"paste",condition:function(A){this.fireEvent("paste",A,1);return false}};Meio.Mask=new Class({Implements:[Options,Events],eventsToBind:["focus","blur","keydown","keypress","paste"],options:{selectOnFocus:true},initialize:function(B,A){this.element=$(B);if(this.element.get("tag")!=="input"||this.element.get("type")!=="text"){return }this.setup(A)},setup:function(A){this.setOptions(A);if(this.element.retrieve("meiomask")){this.remove()}this.ignore=false;this.maxlength=this.element.get("maxlength");this.eventsToBind.each(function(D){this.element.addEvent(D,this.onMask.bindWithEvent(this,this[D]))},this);this.element.store("meiomask",this).erase("maxlength");var C=this.element.get("value");if(C!==""){var B=C.meiomask(this.constructor,this.options);this.element.set("value",B).defaultValue=B}return this},remove:function(){var A=this.element.retrieve("meiomask");if(A){var B=A.maxlength;if(B!==null){this.element.set("maxlength",B)}A.eventsToBind.each(function(C){this.element.removeEvent(C,this[C])},A);this.element.eliminate("meiomask")}return this},onMask:function(B,A){if(this.element.get("readonly")){return true}var C={};C.range=this.element.getSelectedRange();C.isSelection=(C.range.start!==C.range.end);C.isDelKey=(B.event.keyCode==46);C.isBksKey=(B.event.keyCode==8||(Browser.Platform.ipod&&B.code==127));C.isRemoveKey=(C.isBksKey||C.isDelKey);A.call(this,B,C);return true},keydown:function(B,C){this.ignore=(Meio.Mask.ignoreKeys[B.code]&&!C.isRemoveKey)||B.control||B.meta||B.alt;if(this.ignore||C.isRemoveKey){var A=Meio.Mask.ignoreKeys[B.code]||"";this.fireEvent("valid",[this.element,B.code,A])}(Browser.Platform.ipod||(Meio.Mask.onlyKeyDownRepeat&&C.isRemoveKey))?this.keypress(B,C):true},focus:function(B,C){var A=this.element;A.store("meiomask:focusvalue",A.get("value"))},blur:function(B,C){var A=this.element;if(A.retrieve("meiomask:focusvalue")!=A.get("value")){A.fireEvent("change")}},setSize:function(){if(!this.element.get("size")){this.element.set("size",this.maskArray.length)}},isFixedChar:function(A){return !Meio.Mask.matchRules.contains(A)}});Meio.Mask.extend({matchRules:"",rulesRegex:new RegExp(""),rules:{},setRule:function(A,B){this.setRules({ruleKey:B})},setRules:function(A){$extend(this.rules,A);var B=[];for(rule in A){B.push(rule)}this.matchRules+=B.join("");this.recompileRulesRegex()},removeRule:function(A){delete this.rules[A];this.matchRules=this.matchRules.replace(A,"");this.recompileRulesRegex()},removeRules:function(){var A=Array.flatten(arguments);for(var B=A.length;B--;){this.removeRule(A[B])}},recompileRulesRegex:function(){this.rulesRegex.compile("["+this.matchRules.escapeRegExp()+"]","g")},createMasks:function(B,A){B=B.capitalize();for(mask in A){this[B][mask.camelCase().capitalize()]=new Class({Extends:this[B],options:A[mask]})}},upTo:function(A){A=""+A;return function(D,C,B){if(D.charAt(C-1)==A[0]){return(B<=A[1])}return true}},onlyKeyDownRepeat:(Browser.Engine.trident||(Browser.Engine.webkit&&Browser.Engine.version>=525))}).extend(function(){var B;var D={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"alt",27:"esc",33:"page up",34:"page down",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",224:"command"},C={10:"go",127:"delete"};if(Browser.Platform.ipod){B=C}else{for(var A=1;A<=12;A++){D[111+A]="f"+A}B=D}return{ignoreKeys:B}}()).setRules((function(){var B={"z":{regex:/[a-z]/},"Z":{regex:/[A-Z]/},"a":{regex:/[a-zA-Z]/},"*":{regex:/[0-9a-zA-Z]/},"@":{regex:/[0-9a-zA-ZçáàãâéèêíìóòõôúùüñÇÁÀÃÂÉÈÊÍÌÓÒÕÔÚÙÜÑ]/},"h":{regex:/[0-9]/,check:Meio.Mask.upTo(23)},"d":{regex:/[0-9]/,check:Meio.Mask.upTo(31)},"m":{regex:/[0-9]/,check:Meio.Mask.upTo(12)}};for(var A=0;A<=9;A++){B[A]={regex:new RegExp("[0-"+A+"]")}}return B})());Meio.Mask.Fixed=new Class({Extends:Meio.Mask,options:{autoSetSize:false,placeholder:"_",removeIfInvalid:false,removeInvalidTrailingChars:true},initialize:function(B,A){this.parent(B,A);this.maskArray=this.options.mask.split("");this.maskMold=this.element.get("value")||this.options.mask.replace(Meio.Mask.rulesRegex,this.options.placeholder);this.maskMoldArray=this.maskMold.split("");this.validIndexes=[];if(this.options.autoSetSize){this.setSize()}this.maskArray.each(function(D,C){if(!this.isFixedChar(D)){this.validIndexes.push(C)}},this);this.createUnmaskRegex()},focus:function(A,B){this.element.set("value",this.maskMoldArray.join(""));if(this.options.selectOnFocus){this.element.select()}this.parent(A,B)},blur:function(A,C){this.parent(A,C);var B=this.element.get("value");if(this.options.removeIfInvalid){if(B.contains(this.options.placeholder)){this.maskMoldArray=this.maskMold.split("");this.element.set("value","")}return true}if(this.options.removeInvalidTrailingChars){this.removeInvalidTrailingChars(B)}return true},keypress:function(J,D){if(this.ignore){return true}J.preventDefault();var K=String.fromCharCode(J.code),E=this.maskArray,C,G,B;if(!D.isSelection){var H;if(D.isBksKey){do{C=this.validIndexes.indexOf(--D.range.start)}while(C===-1&&D.range.start>=0);H=this.validIndexes[C]||0}else{do{C=this.validIndexes.indexOf(D.range.start++)}while(C===-1&&D.range.start<E.length);H=this.validIndexes[C+1]}G=this.validIndexes[C];if(!(B=this.testEvents(G,K,J.code,D.isRemoveKey))){return true}if($type(B)==="string"){K=B}this.maskMoldArray[G]=(D.isRemoveKey)?this.options.placeholder:K;this.element.set("value",this.maskMoldArray.join("")).setRange($pick(H,this.maskMoldArray.length))}else{var A=D.range.start,I=D.range.end,F;do{C=this.validIndexes.indexOf(D.range.start++)}while(C===-1&&D.range.start<E.length);do{F=this.validIndexes.indexOf(D.range.end++)}while(F===-1&&D.range.end<E.length);if(!(F-C)){return true}for(G=A;G<I;G++){this.maskMoldArray[G]=this.maskMold.charAt(G)}if(!D.isRemoveKey){G=this.validIndexes[C];if(!(B=this.testEvents(G,K,J.code,D.isRemoveKey))){return true}if($type(B)==="string"){K=B}this.maskMoldArray[G]=K;C++}this.element.set("value",this.maskMoldArray.join(""));this.element.setRange(this.validIndexes[C])}return true},paste:function(B,C){var A=this.applyMask(this.element.get("value"),C.range.start);this.maskMoldArray=A.value;this.element.set("value",this.maskMoldArray.join("")).setRange(A.rangeStart);return true},mask:function(A){return this.applyMask(A).value.join("")},unmask:function(A){return A.replace(this.unmaskRegex,"")},createUnmaskRegex:function(){var A=[].combine(this.options.mask.replace(Meio.Mask.rulesRegex,"").split(""));this.unmaskRegex=new RegExp("["+A.join("").escapeRegExp()+"]","g")},applyMask:function(G,D){var A=G.split(""),C=this.maskArray,E=this.maskMold,B=0,F;while(B<E.length){if(!A[B]){A[B]=E[B]}else{if(Meio.Mask.rules[C[B]]){if(!(F=this.testEntry(B,A[B]))){A.splice(B,1);continue}else{if($type(F)==="string"){A[B]=F}}newStartRange=B}else{if(C[B]!=A[B]){A.splice(B,0,E[B])}else{A[B]=E[B]}}}B++}return{value:A.slice(0,this.maskMold.length),rangeStart:D+1}},removeInvalidTrailingChars:function(E){var B=E.length,D=this.options.placeholder,C=E.length-1,A;while(C>=0){A=false;while(this.isFixedChar(E.charAt(C))&&E.charAt(C)!==D){A=true;C--}while(E.charAt(C)===D){A=true;B=C;C--}if(!A){break}}this.element.set("value",E.substring(0,B))},testEntry:function(D,A){var C=this.maskArray,E=Meio.Mask.rules[C[D]],B=(E&&E.regex.test(A));return(E.check&&B)?E.check(this.element.get("value"),D,A):B},testEvents:function(D,A,E,G){var C=this.maskArray,F=Meio.Mask.rules[C[D]],H;if(!G){var B=B=[this.element,E,A];if(!F||!(H=this.testEntry(D,A))){this.fireEvent("invalid",B);return false}this.fireEvent("valid",B)}return H||true}});Meio.Mask.createMasks("Fixed",{"Phone":{mask:"(99) 9999-9999"},"PhoneUs":{mask:"(999) 999-9999"},"Cpf":{mask:"999.999.999-99"},"Cnpj":{mask:"99.999.999/9999-99"},"Date":{mask:"3d/1m/9999"},"DateUs":{mask:"1m/3d/9999"},"Cep":{mask:"99999-999"},"Time":{mask:"2h:59"},"CC":{mask:"9999 9999 9999 9999"}});Meio.Mask.Reverse=new Class({Extends:Meio.Mask,options:{autoSetSize:false,alignText:true,symbol:"",precision:2,decimal:",",thousands:".",maxLength:19},initialize:function(B,A){this.parent(B,A);var E=this.options.decimal.escapeRegExp(),D=this.options.thousands,F=D.escapeRegExp();if(this.options.alignText){this.element.setStyle("text-align","right")}this.maxlength=this.maxlength||this.options.maxLength;this.thousandsRegex=/(\d+)(\d{3})/;this.removeLeadingZerosRegex=/^0+(.*)$/;this.decimalNumberRegex=/^\d$/;this.thousandsReplaceStr="$1"+D+"$2";this.thousandsReplaceRegex=new RegExp(F,"g");this.cleanupRegex=new RegExp("["+F+E+"]","g");var C=this.element.get("value");if(C===""){C=this.mask(C);this.element.set("value",C).defaultValue=C}},focus:function(D,E){var A=this.element,B=A.get("value"),C=this.options.symbol;A.set("value",(B=this.getValue(B,true)));if(this.options.selectOnFocus){A.setRange(C.length,B.length)}this.parent(D,E)},blur:function(B,C){this.parent(B,C);var A=this.element;A.set("value",this.getValue(A.get("value")))},keypress:function(B,D){if(this.ignore){return true}B.preventDefault();var A=String.fromCharCode(B.code),C=this.element.get("value");C=D.isRemoveKey?C.substring(0,C.length-1):this.getValue(C+A);if(!this.testEvents(C.length,A,B.code,D.isRemoveKey)){return true}C=this.forceMask(C,true);this.element.set("value",C).setRange(C.length);return true},testEvents:function(E,A,C,D){var B=[this.element,C,A];if(!D){if(!(this.decimalNumberRegex).test(A)||E>=this.maxlength){this.fireEvent("invalid",B);return false}this.fireEvent("valid",B)}return true},paste:function(B,C){B.preventDefault();var A=this.element;elValue=A.get("value");A.set("value",(elValue=this.forceMask(elValue,true))).setRange(elValue.length);return true},forceMask:function(E,D){E=this.cleanup(E);var A=this.options.precision;if(A){var B=A+1-E.length;if(B>0){E=this.zeroize(E,B)}var C=E.length-A;E=E.substring(0,C)+this.options.decimal+E.substring(C)}return this.getValue(this.maskThousands(E),D)},cleanup:function(A){return this.getValue(A.replace(this.cleanupRegex,"")).replace(this.removeLeadingZerosRegex,"$1")},mask:function(B,A){B=B||"0";B=this.unmask(B).replace(".",this.options.decimal);return this.getValue(this.maskThousands(B),A)},unmask:function(A){return this.toNumber(this.getValue(A))},toNumber:function(C){if(!isFinite(C)){var B=this.options.thousands,A=this.options.decimal;if(B){C=C.replace(this.thousandsReplaceRegex,"")}if(A){C=C.replace(A,".")}}return C.toFloat().toFixed(this.options.precision)},getValue:function(C,B){var A=this.options.symbol;return(C.substring(0,A.length)===A)?B?C:C.substring(A.length):B?A+C:C},maskThousands:function(A){if(this.options.thousands){while(this.thousandsRegex.test(A)){A=A.replace(this.thousandsRegex,this.thousandsReplaceStr)}}return A},zeroize:function(B,A){while(A--){B="0"+B}return B}});Meio.Mask.createMasks("Reverse",{"Integer":{precision:0,maxLength:20},"Decimal":{},"DecimalUs":{thousands:",",decimal:"."},"Reais":{symbol:"R$ "},"Dollar":{symbol:"US$ ",thousands:",",decimal:"."}});Meio.Mask.Repeat=new Class({Extends:Meio.Mask,_keyup:function(A,B){return true},_paste:function(A,B){this.$el.set("value",this.__mask(B.valueArray,this.globals,this.mask.options));return true},_keypress:function(C,D){if(this.ignore||C.control||C.meta||C.alt){return true}var E=String.fromCharCode(C.code),A=this.mask.options.maskArray,B=D.value.replace(this.globals.fixedCharsRegG,"").split("");if(!this.testEvents(A,0,E,C.code)){return false}this.$el.set("value",B.join(""));return true}});Meio.Mask.Regexp=new Class({Extends:Meio.Mask,options:{},initialize:function(B,A){this.parent(B,A);this.regex=new RegExp(this.options.regex)},keypress:function(C,D){if(this.ignore){return true}C.preventDefault();var A=String.fromCharCode(C.code),B=this.element.get("value");B=B.substring(0,D.range.start)+(D.isRemoveKey?"":A)+B.substring(D.range.end);if(this.regex.test(B)){this.element.set("value",B)}return true}});Meio.Mask.createMasks("Regexp",{"Ip":{regex:/^(\d{1,3})(\.\d{1,3}){0,3}?$/,maxLength:15}});(function(){Meio.Mask.dumbInput=new Element("input",{"type":"text"});var A=function(D){return D.camelCase().capitalize()};var C=function(F){var G=[];F=Array.link(F,{mask:String.type,type:String.type,options:Object.type,klass:Class.type});if(F.mask){G=F.mask.contains(".")?F.mask.split("."):[F.type,F.mask]}var D=F.klass||Meio.Mask[A(G[0])][A(G[1])],E=F.options||{};return{klass:D,options:E}};var B=function(E,D){var F=C(D);Meio.Mask.dumbInput.set("value","");return new F.klass(Meio.Mask.dumbInput,F.options)[E](this)};String.implement({meiomask:function(){return B.call(this,"mask",arguments)},meiounmask:function(){return B.call(this,"unmask",arguments)}});Element.Properties.meiomask={set:function(){var D=C(arguments);return this.store("meiomask",new D.klass(this,D.options))},get:function(){return this.retrieve("meiomask")},erase:function(){var D=this.retrieve("meiomask");if(D){D.remove()}return this}};Element.Properties.maxLength=Element.Properties.maxlength={set:function(D){this.setAttribute("maxLength",D);return this},get:function(){var D=this.getAttribute("maxLength",2);return(D===2147483647)?null:D},erase:function(){this.removeAttribute("maxLength");return this}};Element.implement({meiomask:function(D,F,E){return this.set("meiomask",D,F,E)}})})()if(typeof Meio=="undefined"){var Meio={}}$extend(Element.NativeEvents,{"paste":2,"input":2});Element.Events.paste={base:(Browser.Engine.presto||(Browser.Engine.gecko&&Browser.Engine.version<19))?"input":"paste",condition:function(A){this.fireEvent("paste",A,1);return false}};Meio.Mask=new Class({Implements:[Options,Events],eventsToBind:["focus","blur","keydown","keypress","paste"],options:{selectOnFocus:true},initialize:function(B,A){this.element=$(B);if(this.element.get("tag")!=="input"||this.element.get("type")!=="text"){return }this.setup(A)},setup:function(A){this.setOptions(A);if(this.element.retrieve("meiomask")){this.remove()}this.ignore=false;this.maxlength=this.element.get("maxlength");this.eventsToBind.each(function(D){this.element.addEvent(D,this.onMask.bindWithEvent(this,this[D]))},this);this.element.store("meiomask",this).erase("maxlength");var C=this.element.get("value");if(C!==""){var B=C.meiomask(this.constructor,this.options);this.element.set("value",B).defaultValue=B}return this},remove:function(){var A=this.element.retrieve("meiomask");if(A){var B=A.maxlength;if(B!==null){this.element.set("maxlength",B)}A.eventsToBind.each(function(C){this.element.removeEvent(C,this[C])},A);this.element.eliminate("meiomask")}return this},onMask:function(B,A){if(this.element.get("readonly")){return true}var C={};C.range=this.element.getSelectedRange();C.isSelection=(C.range.start!==C.range.end);C.isDelKey=(B.event.keyCode==46);C.isBksKey=(B.event.keyCode==8||(Browser.Platform.ipod&&B.code==127));C.isRemoveKey=(C.isBksKey||C.isDelKey);A.call(this,B,C);return true},keydown:function(B,C){this.ignore=(Meio.Mask.ignoreKeys[B.code]&&!C.isRemoveKey)||B.control||B.meta||B.alt;if(this.ignore||C.isRemoveKey){var A=Meio.Mask.ignoreKeys[B.code]||"";this.fireEvent("valid",[this.element,B.code,A])}(Browser.Platform.ipod||(Meio.Mask.onlyKeyDownRepeat&&C.isRemoveKey))?this.keypress(B,C):true},focus:function(B,C){var A=this.element;A.store("meiomask:focusvalue",A.get("value"))},blur:function(B,C){var A=this.element;if(A.retrieve("meiomask:focusvalue")!=A.get("value")){A.fireEvent("change")}},setSize:function(){if(!this.element.get("size")){this.element.set("size",this.maskArray.length)}},isFixedChar:function(A){return !Meio.Mask.matchRules.contains(A)}});Meio.Mask.extend({matchRules:"",rulesRegex:new RegExp(""),rules:{},setRule:function(A,B){this.setRules({ruleKey:B})},setRules:function(A){$extend(this.rules,A);var B=[];for(rule in A){B.push(rule)}this.matchRules+=B.join("");this.recompileRulesRegex()},removeRule:function(A){delete this.rules[A];this.matchRules=this.matchRules.replace(A,"");this.recompileRulesRegex()},removeRules:function(){var A=Array.flatten(arguments);for(var B=A.length;B--;){this.removeRule(A[B])}},recompileRulesRegex:function(){this.rulesRegex.compile("["+this.matchRules.escapeRegExp()+"]","g")},createMasks:function(B,A){B=B.capitalize();for(mask in A){this[B][mask.camelCase().capitalize()]=new Class({Extends:this[B],options:A[mask]})}},upTo:function(A){A=""+A;return function(D,C,B){if(D.charAt(C-1)==A[0]){return(B<=A[1])}return true}},onlyKeyDownRepeat:(Browser.Engine.trident||(Browser.Engine.webkit&&Browser.Engine.version>=525))}).extend(function(){var B;var D={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"alt",27:"esc",33:"page up",34:"page down",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",224:"command"},C={10:"go",127:"delete"};if(Browser.Platform.ipod){B=C}else{for(var A=1;A<=12;A++){D[111+A]="f"+A}B=D}return{ignoreKeys:B}}()).setRules((function(){var B={"z":{regex:/[a-z]/},"Z":{regex:/[A-Z]/},"a":{regex:/[a-zA-Z]/},"*":{regex:/[0-9a-zA-Z]/},"@":{regex:/[0-9a-zA-ZçáàãâéèêíìóòõôúùüñÇÁÀÃÂÉÈÊÍÌÓÒÕÔÚÙÜÑ]/},"h":{regex:/[0-9]/,check:Meio.Mask.upTo(23)},"d":{regex:/[0-9]/,check:Meio.Mask.upTo(31)},"m":{regex:/[0-9]/,check:Meio.Mask.upTo(12)}};for(var A=0;A<=9;A++){B[A]={regex:new RegExp("[0-"+A+"]")}}return B})());Meio.Mask.Fixed=new Class({Extends:Meio.Mask,options:{autoSetSize:false,placeholder:"_",removeIfInvalid:false,removeInvalidTrailingChars:true},initialize:function(B,A){this.parent(B,A);this.maskArray=this.options.mask.split("");this.maskMold=this.element.get("value")||this.options.mask.replace(Meio.Mask.rulesRegex,this.options.placeholder);this.maskMoldArray=this.maskMold.split("");this.validIndexes=[];if(this.options.autoSetSize){this.setSize()}this.maskArray.each(function(D,C){if(!this.isFixedChar(D)){this.validIndexes.push(C)}},this);this.createUnmaskRegex()},focus:function(A,B){this.element.set("value",this.maskMoldArray.join(""));if(this.options.selectOnFocus){this.element.select()}this.parent(A,B)},blur:function(A,C){this.parent(A,C);var B=this.element.get("value");if(this.options.removeIfInvalid){if(B.contains(this.options.placeholder)){this.maskMoldArray=this.maskMold.split("");this.element.set("value","")}return true}if(this.options.removeInvalidTrailingChars){this.removeInvalidTrailingChars(B)}return true},keypress:function(J,D){if(this.ignore){return true}J.preventDefault();var K=String.fromCharCode(J.code),E=this.maskArray,C,G,B;if(!D.isSelection){var H;if(D.isBksKey){do{C=this.validIndexes.indexOf(--D.range.start)}while(C===-1&&D.range.start>=0);H=this.validIndexes[C]||0}else{do{C=this.validIndexes.indexOf(D.range.start++)}while(C===-1&&D.range.start<E.length);H=this.validIndexes[C+1]}G=this.validIndexes[C];if(!(B=this.testEvents(G,K,J.code,D.isRemoveKey))){return true}if($type(B)==="string"){K=B}this.maskMoldArray[G]=(D.isRemoveKey)?this.options.placeholder:K;var L=$pick(H,this.maskMoldArray.length);this.element.set("value",this.maskMoldArray.join("")).selectRange(L,L)}else{var A=D.range.start,I=D.range.end,F;do{C=this.validIndexes.indexOf(D.range.start++)}while(C===-1&&D.range.start<E.length);do{F=this.validIndexes.indexOf(D.range.end++)}while(F===-1&&D.range.end<E.length);if(!(F-C)){return true}for(G=A;G<I;G++){this.maskMoldArray[G]=this.maskMold.charAt(G)}if(!D.isRemoveKey){G=this.validIndexes[C];if(!(B=this.testEvents(G,K,J.code,D.isRemoveKey))){return true}if($type(B)==="string"){K=B}this.maskMoldArray[G]=K;C++}this.element.set("value",this.maskMoldArray.join(""));this.element.selectRange(this.validIndexes[C],this.validIndexes[C])}return true},paste:function(B,C){var A=this.applyMask(this.element.get("value"),C.range.start);this.maskMoldArray=A.value;this.element.set("value",this.maskMoldArray.join("")).selectRange(A.rangeStart,A.rangeStart);return true},mask:function(A){return this.applyMask(A).value.join("")},unmask:function(A){return A.replace(this.unmaskRegex,"")},createUnmaskRegex:function(){var A=[].combine(this.options.mask.replace(Meio.Mask.rulesRegex,"").split(""));this.unmaskRegex=new RegExp("["+A.join("").escapeRegExp()+"]","g")},applyMask:function(G,D){var A=G.split(""),C=this.maskArray,E=this.maskMold,B=0,F;while(B<E.length){if(!A[B]){A[B]=E[B]}else{if(Meio.Mask.rules[C[B]]){if(!(F=this.testEntry(B,A[B]))){A.splice(B,1);continue}else{if($type(F)==="string"){A[B]=F}}newStartRange=B}else{if(C[B]!=A[B]){A.splice(B,0,E[B])}else{A[B]=E[B]}}}B++}return{value:A.slice(0,this.maskMold.length),rangeStart:D+1}},removeInvalidTrailingChars:function(E){var B=E.length,D=this.options.placeholder,C=E.length-1,A;while(C>=0){A=false;while(this.isFixedChar(E.charAt(C))&&E.charAt(C)!==D){A=true;C--}while(E.charAt(C)===D){A=true;B=C;C--}if(!A){break}}this.element.set("value",E.substring(0,B))},testEntry:function(D,A){var C=this.maskArray,E=Meio.Mask.rules[C[D]],B=(E&&E.regex.test(A));return(E.check&&B)?E.check(this.element.get("value"),D,A):B},testEvents:function(D,A,E,G){var C=this.maskArray,F=Meio.Mask.rules[C[D]],H;if(!G){var B=B=[this.element,E,A];if(!F||!(H=this.testEntry(D,A))){this.fireEvent("invalid",B);return false}this.fireEvent("valid",B)}return H||true}});Meio.Mask.createMasks("Fixed",{"Phone":{mask:"(99) 9999-9999"},"PhoneUs":{mask:"(999) 999-9999"},"Cpf":{mask:"999.999.999-99"},"Cnpj":{mask:"99.999.999/9999-99"},"Date":{mask:"3d/1m/9999"},"DateUs":{mask:"1m/3d/9999"},"Cep":{mask:"99999-999"},"Time":{mask:"2h:59"},"CC":{mask:"9999 9999 9999 9999"}});Meio.Mask.Reverse=new Class({Extends:Meio.Mask,options:{autoSetSize:false,alignText:true,symbol:"",precision:2,decimal:",",thousands:".",maxLength:19},initialize:function(B,A){this.parent(B,A);var E=this.options.decimal.escapeRegExp(),D=this.options.thousands,F=D.escapeRegExp();if(this.options.alignText){this.element.setStyle("text-align","right")}this.maxlength=this.maxlength||this.options.maxLength;this.thousandsRegex=/(\d+)(\d{3})/;this.removeLeadingZerosRegex=/^0+(.*)$/;this.decimalNumberRegex=/^\d$/;this.thousandsReplaceStr="$1"+D+"$2";this.thousandsReplaceRegex=new RegExp(F,"g");this.cleanupRegex=new RegExp("["+F+E+"]","g");var C=this.element.get("value");if(C===""){C=this.mask(C);this.element.set("value",C).defaultValue=C}},focus:function(D,E){var A=this.element,B=A.get("value"),C=this.options.symbol;A.set("value",(B=this.getValue(B,true)));if(this.options.selectOnFocus){A.selectRange(C.length,B.length)}this.parent(D,E)},blur:function(B,C){this.parent(B,C);var A=this.element;A.set("value",this.getValue(A.get("value")))},keypress:function(B,D){if(this.ignore){return true}B.preventDefault();var A=String.fromCharCode(B.code),C=this.element.get("value");C=D.isRemoveKey?C.substring(0,C.length-1):this.getValue(C+A);if(!this.testEvents(C.length,A,B.code,D.isRemoveKey)){return true}C=this.forceMask(C,true);this.element.set("value",C).selectRange(C.length,C.length);return true},testEvents:function(E,A,C,D){var B=[this.element,C,A];if(!D){if(!(this.decimalNumberRegex).test(A)||E>=this.maxlength){this.fireEvent("invalid",B);return false}this.fireEvent("valid",B)}return true},paste:function(B,C){B.preventDefault();var A=this.element;elValue=A.get("value");A.set("value",(elValue=this.forceMask(elValue,true))).selectRange(elValue.length,elValue.length);return true},forceMask:function(E,D){E=this.cleanup(E);var A=this.options.precision;if(A){var B=A+1-E.length;if(B>0){E=this.zeroize(E,B)}var C=E.length-A;E=E.substring(0,C)+this.options.decimal+E.substring(C)}return this.getValue(this.maskThousands(E),D)},cleanup:function(A){return this.getValue(A.replace(this.cleanupRegex,"")).replace(this.removeLeadingZerosRegex,"$1")},mask:function(B,A){B=B||"0";B=this.unmask(B).replace(".",this.options.decimal);return this.getValue(this.maskThousands(B),A)},unmask:function(A){return this.toNumber(this.getValue(A))},toNumber:function(C){if(!isFinite(C)){var B=this.options.thousands,A=this.options.decimal;if(B){C=C.replace(this.thousandsReplaceRegex,"")}if(A){C=C.replace(A,".")}}return C.toFloat().toFixed(this.options.precision)},getValue:function(C,B){var A=this.options.symbol;return(C.substring(0,A.length)===A)?B?C:C.substring(A.length):B?A+C:C},maskThousands:function(A){if(this.options.thousands){while(this.thousandsRegex.test(A)){A=A.replace(this.thousandsRegex,this.thousandsReplaceStr)}}return A},zeroize:function(B,A){while(A--){B="0"+B}return B}});Meio.Mask.createMasks("Reverse",{"Integer":{precision:0,maxLength:20},"Decimal":{},"DecimalUs":{thousands:",",decimal:"."},"Reais":{symbol:"R$ "},"Dollar":{symbol:"US$ ",thousands:",",decimal:"."}});Meio.Mask.Repeat=new Class({Extends:Meio.Mask,_keyup:function(A,B){return true},_paste:function(A,B){this.$el.set("value",this.__mask(B.valueArray,this.globals,this.mask.options));return true},_keypress:function(C,D){if(this.ignore||C.control||C.meta||C.alt){return true}var E=String.fromCharCode(C.code),A=this.mask.options.maskArray,B=D.value.replace(this.globals.fixedCharsRegG,"").split("");if(!this.testEvents(A,0,E,C.code)){return false}this.$el.set("value",B.join(""));return true}});Meio.Mask.Regexp=new Class({Extends:Meio.Mask,options:{},initialize:function(B,A){this.parent(B,A);this.regex=new RegExp(this.options.regex)},keypress:function(C,D){if(this.ignore){return true}C.preventDefault();var A=String.fromCharCode(C.code),B=this.element.get("value");B=B.substring(0,D.range.start)+(D.isRemoveKey?"":A)+B.substring(D.range.end);if(this.regex.test(B)){this.element.set("value",B)}return true}});Meio.Mask.createMasks("Regexp",{"Ip":{regex:/^(\d{1,3})(\.\d{1,3}){0,3}?$/,maxLength:15}});(function(){Meio.Mask.dummyInput=new Element("input",{"type":"text"});var A=function(D){return D.camelCase().capitalize()};var C=function(F){var G=[];F=Array.link(F,{mask:String.type,type:String.type,options:Object.type,klass:Class.type});if(F.mask){G=F.mask.contains(".")?F.mask.split("."):[F.type,F.mask]}var D=F.klass||Meio.Mask[A(G[0])][A(G[1])],E=F.options||{};return{klass:D,options:E}};var B=function(E,D){var F=C(D);Meio.Mask.dummyInput.set("value","");return new F.klass(Meio.Mask.dummyInput,F.options)[E](this)};String.implement({meiomask:function(){return B.call(this,"mask",arguments)},meiounmask:function(){return B.call(this,"unmask",arguments)}});Element.Properties.meiomask={set:function(){var D=C(arguments);return this.store("meiomask",new D.klass(this,D.options))},get:function(){return this.retrieve("meiomask")},erase:function(){var D=this.retrieve("meiomask");if(D){D.remove()}return this}};Element.Properties.maxLength=Element.Properties.maxlength={set:function(D){this.setAttribute("maxLength",D);return this},get:function(){var D=this.getAttribute("maxLength",2);return(D===2147483647)?null:D},erase:function(){this.removeAttribute("maxLength");return this}};Element.implement({meiomask:function(D,F,E){return this.set("meiomask",D,F,E)}})})()